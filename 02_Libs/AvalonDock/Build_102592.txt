Source: http://avalondock.codeplex.com/SourceControl/changeset/102592