<Window x:Class="Edi.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"

        xmlns:avalonDockProperties="clr-namespace:AvalonDock.Properties;assembly=AvalonDock"
        xmlns:avalonDock="http://avalondock.codeplex.com"

        xmlns:shell="clr-namespace:Microsoft.Windows.Shell;assembly=AvalonDock"
        xmlns:pane="clr-namespace:Edi.View.Pane"
        xmlns:local="clr-namespace:Edi"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:syswin="clr-namespace:System.Windows;assembly=PresentationCore"

        xmlns:behav="clr-namespace:EdiViews.Behaviour;assembly=EdiViews"
        xmlns:view="clr-namespace:Edi.View"
        xmlns:vm="clr-namespace:Edi.ViewModel"
        xmlns:conv="clr-namespace:Edi.Converter"

        xmlns:EdiViewsConv="clr-namespace:EdiViews.Converter;assembly=EdiViews"
        xmlns:avalonEdit="clr-namespace:ICSharpCode.AvalonEdit.Highlighting;assembly=ICSharpCode.AvalonEdit"

        xmlns:yalvView="clr-namespace:YalvLib.View;assembly=YalvLib"
        xmlns:busi="clr-namespace:YalvLib.Behaviour.BusyIndicatorBehavior;assembly=YalvLib"

        xmlns:cmd="clr-namespace:Edi"

        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        mc:Ignorable="d" 
        d:DesignHeight="300" d:DesignWidth="700"             

        Title="{Binding ApplicationTitle}"
        Icon="/Edi;component/EdiLogo.ico"
        behav:DialogCloser.DialogResult="{Binding DialogCloseResult}"        
        >
  <Window.Resources>
    <conv:ActiveDocumentConverter x:Key="ActiveDocumentConverter"/>
    <avalonDock:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    <EdiViewsConv:BooleanToTypeModeStringConverter x:Key="DisplayTypeModeConverter" />
  </Window.Resources>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <Menu Grid.Row="0">
      <MenuItem Header="_File">
        <MenuItem Header="New" Command="New"/>
        <MenuItem Header="Open" Command="Open"/>
        <Separator/>
        <MenuItem Header="Save" Command="Save" ToolTipService.ShowOnDisabled="True" />
        <MenuItem Header="Save As..." Command="SaveAs"/>
        <MenuItem ItemsSource="{Binding RecentFiles.MruList.ListOfMRUEntries}" Grid.Row="0" Header="Recent Files"
                  Visibility="{Binding Path=RecentFiles.MruList.ListOfMRUEntries, Mode=OneWay, Converter={EdiViewsConv:ZeroToVisibilityConverter}}">
          <MenuItem.ItemContainerStyle>
            <Style TargetType="MenuItem">
              <Setter Property="Header" Value="{Binding DisplayPathFileName, Mode=OneWay}" />
              <Setter Property="Command" Value="cmd:AppCommand.LoadFile" />
              <Setter Property="CommandParameter" Value="{Binding PathFileName, Mode=OneWay}" />
            </Style>
          </MenuItem.ItemContainerStyle>
        </MenuItem>
        <Separator/>
        <MenuItem Header="Close" Command="cmd:AppCommand.CloseFile"
                                 CommandParameter="{Binding ActiveDocument}"/>
        <Separator/>
        <MenuItem Header="Exit" Command="cmd:AppCommand.Exit" />
      </MenuItem>
      <MenuItem Header="_Edit">
        <MenuItem Header="_Undo" Command="Undo">
        <MenuItem.Icon>
          <Image Source="{StaticResource Image_Undo}" Height="16" />
        </MenuItem.Icon>
        </MenuItem>
        <MenuItem Header="_Redo" Command="Redo">
        <MenuItem.Icon>
          <Image Source="{StaticResource Image_Redo}" Height="16" />
        </MenuItem.Icon>
        </MenuItem>
        <Separator />
        <MenuItem Header="Cut" Command="Cut"
                  ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}">
          <MenuItem.Icon>
            <Image Source="{StaticResource Image_Cut}" Height="16" />
          </MenuItem.Icon>
        </MenuItem>
        <MenuItem Header="Copy" Command="Copy"
          ToolTip="Copy">
          <MenuItem.Icon>
            <Image Source="{StaticResource Image_Copy}" Height="16" />
          </MenuItem.Icon>
        </MenuItem>
        <MenuItem Header="Paste" Command="Paste"
          ToolTip="Paste">
          <MenuItem.Icon>
            <Image Source="{StaticResource Image_Paste}" Height="16"/>
          </MenuItem.Icon>
        </MenuItem>
        <MenuItem Header="Delete" Command="Delete"
          ToolTip="Delete" ToolTipService.ShowOnDisabled="True">
          <MenuItem.Icon>
            <Image Source="{StaticResource Image_Delete}" Height="16"/>
          </MenuItem.Icon>
        </MenuItem>
        <Separator />
        <MenuItem Command="SelectAll" Header="Select All"
                  ToolTip="Select All"  ToolTipService.ShowOnDisabled="True"/>
        <Separator/>
        <MenuItem Header="Go to line..." Command="cmd:AppCommand.GotoLine"
                  ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}">
          <MenuItem.Icon>
            <Image Source="{StaticResource Image_EditFind}" Width="16" />
          </MenuItem.Icon>
        </MenuItem>
        <MenuItem Header="Find" Command="cmd:AppCommand.FindText"
                  ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}"/>

        <MenuItem Header="Replace..." Command="cmd:AppCommand.ReplaceText"
                  ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}"/>
      </MenuItem>
      <MenuItem Header="_View">
        <MenuItem Header="_Themes" ItemsSource="{Binding Skins.Themes}">
          <MenuItem.Resources>
            <RadioButton x:Key="rb" x:Shared="false" HorizontalAlignment="Right"  VerticalAlignment="Center"
                         GroupName="MenuGroup"
                         IsHitTestVisible="False"
                         Margin="3,0,0,0" IsChecked="{Binding IsChecked, Mode=OneWay}">
                <RadioButton.Template>
                <ControlTemplate TargetType="{x:Type RadioButton}">
                  <!-- Data="M 0,5.1 L 1.7,5.2 L 3.4,7.1 L 8,0.4 L 9.2,0 L 3.3,10.8 Z" -->
                  <Grid>
                    <Path x:Name="uncheck" Visibility="Collapsed" Margin="7,0,0,0" VerticalAlignment="Center"
                        Fill="Transparent">
                      <Path.Data>
                        <PathGeometry>
                          <PathGeometry.Figures>
                            <PathFigureCollection>
                              <PathFigure IsClosed="True" StartPoint="0,0">
                                <PathFigure.Segments>
                                  <PathSegmentCollection>
                                    <LineSegment Point="16,0" />
                                    <LineSegment Point="16,16" />
                                    <LineSegment Point="0,16" />
                                  </PathSegmentCollection>
                                </PathFigure.Segments>
                              </PathFigure>
                            </PathFigureCollection>
                          </PathGeometry.Figures>
                        </PathGeometry>
                      </Path.Data>
                    </Path>
                    <Path x:Name="check" Visibility="Collapsed" Margin="7,0,0,0" VerticalAlignment="Center"
                        Fill="{TemplateBinding MenuItem.Foreground}">
                      <Path.Data>
                        <PathGeometry>
                          <PathGeometry.Figures>
                            <PathFigureCollection>
                              <PathFigure IsClosed="True" StartPoint="2.5,8">
                                <PathFigure.Segments>
                                  <PathSegmentCollection>
                                    <LineSegment Point="5,13.5" />
                                    <LineSegment Point="7,13.5" />
                                    <LineSegment Point="12.5,2.5" />
                                    <LineSegment Point="5.5,11.5" />
                                  </PathSegmentCollection>
                                </PathFigure.Segments>
                              </PathFigure>
                            </PathFigureCollection>
                          </PathGeometry.Figures>
                        </PathGeometry>
                      </Path.Data>
                    </Path>
                  </Grid>
                  <ControlTemplate.Triggers>
                    <Trigger Property="IsChecked" Value="True">
                      <Setter TargetName="check" Property="Visibility" Value="Visible" />
                    </Trigger>
                    <Trigger Property="IsChecked" Value="False">
                      <Setter TargetName="uncheck" Property="Visibility" Value="Visible" />
                    </Trigger>
                  </ControlTemplate.Triggers>
                </ControlTemplate>
              </RadioButton.Template>
            </RadioButton>
          </MenuItem.Resources>
          <MenuItem.ItemContainerStyle>
            <Style TargetType="MenuItem" BasedOn="{StaticResource {x:Type MenuItem}}">
              <Setter Property="Header" Value="{Binding Text}" />
              <Setter Property="Icon" Value="{DynamicResource rb}" />
              <Setter Property="Command" Value="cmd:AppCommand.ViewTheme" />
              <Setter Property="CommandParameter" Value="{Binding ThemeID}" />
              <Setter Property="Margin" Value="3,3,3,0" />

              <!-- http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/63696841-0358-4f7a-abe1-e6062518e3d6 -->
              <Setter Property="behav:MergeStyleBehaviour.AutoMergeStyle" Value="True"/>
            </Style>
          </MenuItem.ItemContainerStyle>
        </MenuItem>

        <MenuItem Header="Start Page" Command="cmd:AppCommand.ShowStartPage" />
      </MenuItem>

      <!-- XXXXXXXXXXXXXXXXXXXX -->
      <MenuItem Header="_Tools">
        <MenuItem Header="RecentFiles" IsChecked="{Binding RecentFiles.IsVisible, Mode=TwoWay}" IsCheckable="True"/>
        <MenuItem Header="Properties" IsChecked="{Binding FileStats.IsVisible, Mode=TwoWay}" IsCheckable="True"/>
        <MenuItem Header="Log4Net Tool Window" IsChecked="{Binding Log4NetTool.IsVisible, Mode=TwoWay}" IsCheckable="True"/>
      </MenuItem>

      <MenuItem Header="_Help">
        <MenuItem Header="About" Command="cmd:AppCommand.About" />
      </MenuItem>
    </Menu>

    <ToolBarTray Grid.Row="1" SnapsToDevicePixels="True" >
      <ToolBar  VerticalAlignment="Stretch" ToolBarTray.IsLocked="True"
                SnapsToDevicePixels="True"
                behav:HideToolbarOverflowButton.HideGrip="True">
        <Button Command="New" SnapsToDevicePixels="True"
                ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}">
          <Image Source="{StaticResource Image_New}" Height="32" SnapsToDevicePixels="True" />
        </Button>
        <Button Command="Open" SnapsToDevicePixels="True"
                ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}">
          <Image Source="{StaticResource Image_Open}" Height="32" SnapsToDevicePixels="True" />
        </Button>
        <Button Command="Save" SnapsToDevicePixels="True"
              ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}">
          <Image Source="{StaticResource Image_Save}" Height="32" SnapsToDevicePixels="True" />
        </Button>

        <Button Command="cmd:AppCommand.SaveAll" SnapsToDevicePixels="True"
              ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}">
          <Image Source="{StaticResource Image_SaveAll}" Height="32" SnapsToDevicePixels="True" />
        </Button>

        <Separator Margin="3" SnapsToDevicePixels="True" />

        <!-- TextArea Edit Commands work via
       (1) 'Command="Copy"'
           'Command="Cut"'
           'Command="Paste"'
           'Command="Delete"'

            that is via ApplicationCommands.Cut (WPF standard fucntionality since AvalonEdit registers its Edit commands there).

       (2) Or they can be executed via custom commands defined in Workspace_Commands:
            
            Command="cmd:AppCommand.CutItem"
            CommandParameter="{Binding ElementName=dockManager}"

            Command="cmd:AppCommand.CopyItem"
            CommandParameter="{Binding ElementName=dockManager}"

            Command="cmd:AppCommand.PasteItem"
            CommandParameter="{Binding ElementName=dockManager}"

            Command="cmd:AppCommand.DeleteItem"
            CommandParameter="{Binding ElementName=dockManager}"

            In any case, the commandbinding does not succeed when the document is not docked
            (see comment in Workspace_Commands.PerformTextAreaEdit for more details)
      -->
        <Button Command="Copy" SnapsToDevicePixels="True"
                ToolTip="Copy">
          <Image Source="{StaticResource Image_Copy}" Height="32" SnapsToDevicePixels="True" />
        </Button>
        <Button Command="Cut" SnapsToDevicePixels="True"
                ToolTip="Cut">
          <Image Source="{StaticResource Image_Cut}" Height="32" SnapsToDevicePixels="True" />
        </Button>
        <Button Command="Paste" SnapsToDevicePixels="True"
                ToolTip="Paste">
          <Image Source="{StaticResource Image_Paste}" Height="32" SnapsToDevicePixels="True" />
        </Button>
        <Button Command="Delete" SnapsToDevicePixels="True"
                ToolTip="Delete">
          <Image Source="{StaticResource Image_Delete}" Height="32"/>
        </Button>

        <Separator Margin="3"/>

        <Button Command="Undo" SnapsToDevicePixels="True"
                ToolTip="Undo">
          <Image Source="{StaticResource Image_Undo}" Height="32"/>
        </Button>
        <Button Command="Redo" SnapsToDevicePixels="True"
                ToolTip="Redo">
          <Image Source="{StaticResource Image_Redo}" Height="32"/>
        </Button>
        <Separator/>
        <ToggleButton IsChecked="{Binding ActiveEdiDocument.WordWrap, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                      CommandParameter="{x:Static vm:ToggleEditorOption.WordWrap}"
                      Command="{Binding ToggleEditorOptionCommand}"
                      ToolTip="Word Wrap">
          <Image Source="{StaticResource Image_WordWrap}" Height="32"/>
        </ToggleButton>
        <ToggleButton IsChecked="{Binding ActiveEdiDocument.ShowLineNumbers, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                  CommandParameter="{x:Static vm:ToggleEditorOption.ShowLineNumber}"
                  Command="{Binding ToggleEditorOptionCommand}"
                  ToolTip="Show Line Numbers">
          <Image Source="{StaticResource Image_ShowLineNumbers}" Height="32"/>
        </ToggleButton>
        <ToggleButton IsChecked="{Binding ActiveEdiDocument.ShowEndOfLine, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                      Command="{Binding ToggleEditorOptionCommand}"
                      CommandParameter="{x:Static vm:ToggleEditorOption.ShowEndOfLine}"
                      ToolTip="Show End of Line">
          <Image Source="{StaticResource Image_EndOfLine}" Height="32"/>
        </ToggleButton>
        <ToggleButton IsChecked="{Binding ActiveEdiDocument.ShowSpaces, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                      Command="{Binding ToggleEditorOptionCommand}"
                      CommandParameter="{x:Static vm:ToggleEditorOption.ShowSpaces}"
                      ToolTip="Show Space Characters">
          <Image Source="{StaticResource Image_Space}" Height="32"/>
        </ToggleButton>
        <ToggleButton IsChecked="{Binding ActiveEdiDocument.ShowTabs, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                      Command="{Binding ToggleEditorOptionCommand}"
                      CommandParameter="{x:Static vm:ToggleEditorOption.ShowTabs}"
                      ToolTip="Show Tab Characters">
          <Image Source="{StaticResource Image_Tabs}" Height="32"/>
        </ToggleButton>
        
        <Separator Visibility="{Binding Path=ActiveDocument, Mode=OneWay, Converter={conv:ActiveDocumentToVisibilityConverter}}"
                   Margin="3" />
        <!-- Select Highlighting pattern combobox is visible only if there is an active document (otherwise there ain't much to highlight) -->
        <ComboBox SelectedItem="{Binding ActiveEdiDocument.HighlightingDefinition}"
				          ItemsSource="{Binding Source={x:Static avalonEdit:HighlightingManager.Instance}, Path=HighlightingDefinitionsSortedByName}"
                  Visibility="{Binding Path=ActiveDocument, Mode=OneWay, Converter={conv:ActiveDocumentToVisibilityConverter}}"
                  MinWidth="100" Margin="3,0"
                  ToolTip="Text Highlighting"
        />
        <Button Command="cmd:AppCommand.DisableHighlighting" SnapsToDevicePixels="True"
                Margin="3,0"
                Visibility="{Binding Path=ActiveDocument, Mode=OneWay, Converter={conv:ActiveDocumentToVisibilityConverter}}"
                ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}">
          <Image Source="{StaticResource Image_SyntaxHighlighting}" Height="32"/>
        </Button>
      </ToolBar>
    </ToolBarTray>

    <avalonDock:DockingManager x:Name="dockManager" 
                               AnchorablesSource="{Binding Tools}" 
                               DocumentsSource="{Binding Files}"
                               ActiveContent="{Binding ActiveDocument, Mode=TwoWay, Converter={StaticResource ActiveDocumentConverter}}"
                               Grid.Row="2"
                               AllowDrop="True"
                               behav:DropFileCommand.DropCommand="cmd:AppCommand.LoadFile">
      <avalonDock:DockingManager.DocumentHeaderTemplate>
        <DataTemplate>
          <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Title}" TextTrimming="CharacterEllipsis" VerticalAlignment="Center" />
            <!-- Show IsReadOnly Icon in document tab if that properties' present and true -->
            <Image Source="{StaticResource Image_DocTabReadOnly}" Margin="3,0,0,0"
                    VerticalAlignment="Center">
              <Image.Visibility>
                <PriorityBinding FallbackValue="Collapsed">
                  <Binding Path="Content.IsReadOnly" Mode="OneWay" Converter="{StaticResource BoolToVisibilityConverter}" />
                </PriorityBinding>
              </Image.Visibility>
              <Image.ToolTip>
                <PriorityBinding FallbackValue="">
                  <Binding Path="Content.IsReadOnlyReason" Mode="OneWay" />
                </PriorityBinding>
              </Image.ToolTip>
            </Image>
          </StackPanel>
        </DataTemplate>
      </avalonDock:DockingManager.DocumentHeaderTemplate>
      <avalonDock:DockingManager.DocumentContextMenu>
        <ContextMenu>
          <MenuItem Header="Open Containing Folder..." 
                    Command="{Binding Model.OpenContainingFolderCommand}"
                    />
          <MenuItem Header="Copy URL to Clipboard" 
                    Command="{Binding Model.CopyFullPathtoClipboard}"
                    />
          <Separator/>

          <MenuItem Header="{x:Static avalonDockProperties:Resources.Document_Close}" 
                    Command="{Binding Path=CloseCommand}"
                    Visibility="{Binding Path=IsEnabled, RelativeSource={RelativeSource Self}, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                    />
          <MenuItem Header="{x:Static avalonDockProperties:Resources.Document_CloseAllButThis}" 
                    Command="{Binding Path=CloseAllButThisCommand}"
                    />
          <MenuItem Header="{x:Static avalonDockProperties:Resources.Document_Float}" 
                    Command="{Binding Path=FloatCommand}"
                    />
          <MenuItem Header="{x:Static avalonDockProperties:Resources.Document_DockAsDocument}" 
                    Command="{Binding Path=DockAsDocumentCommand}"
                    />
          <MenuItem Header="{x:Static avalonDockProperties:Resources.Document_NewHorizontalTabGroup}" 
                    Command="{Binding Path=NewHorizontalTabGroupCommand}"
                    Visibility="{Binding Path=IsEnabled, RelativeSource={RelativeSource Self}, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                    >
            <MenuItem.Icon>
              <Image Source="/AvalonDock.Themes.Aero;component/Images/HTabGroup.png" Stretch="Uniform" Width="14"/>
            </MenuItem.Icon>
          </MenuItem>
        </ContextMenu>
      </avalonDock:DockingManager.DocumentContextMenu>
      <avalonDock:DockingManager.LayoutItemTemplateSelector>
          <pane:PanesTemplateSelector>
          <pane:PanesTemplateSelector.StartPageViewTemplate>
            <DataTemplate>
              <view:StartPage>
              </view:StartPage>
            </DataTemplate>
          </pane:PanesTemplateSelector.StartPageViewTemplate>
          <pane:PanesTemplateSelector.Log4NetViewTemplate><!-- Log4Net Document Viewer -->
            <DataTemplate>
              <Grid busi:BusyIndicatorBehavior.BusyState="{Binding Yalv.LogItems.LogFile.IsLoading}">
                <yalvView:YalvView DataContext="{Binding Yalv}"
                                   Margin="0,3,0,0"
                                   Columns="{Binding LogItems.DataGridColumns}"
                                   Focusable="True"
                                   KeyboardNavigation.IsTabStop="True"
                                   Name="ValvView"
                                   behav:KeyboardFocus.On="{Binding ElementName=ValvView}"
              />
              </Grid>
            </DataTemplate>
          </pane:PanesTemplateSelector.Log4NetViewTemplate>
          <pane:PanesTemplateSelector.Log4NetToolViewTemplate><!-- Log4Net Tool Window -->
            <DataTemplate>
              <view:Log4NetToolView />
            </DataTemplate>
          </pane:PanesTemplateSelector.Log4NetToolViewTemplate>
          <pane:PanesTemplateSelector.Log4NetMessageToolViewTemplate>
            <DataTemplate>
              <view:Log4NetMessageView />
            </DataTemplate>
          </pane:PanesTemplateSelector.Log4NetMessageToolViewTemplate>
          <pane:PanesTemplateSelector.FileViewTemplate>
            <DataTemplate>    <!-- Known problem: Options must be bound or the control will show a gray bar otherwise -->
              <view:EdiView /><!-- TextEditor -->
            </DataTemplate>
          </pane:PanesTemplateSelector.FileViewTemplate>
          <pane:PanesTemplateSelector.FileStatsViewTemplate>
            <DataTemplate>
              <StackPanel Orientation="Vertical" Background="{StaticResource ToolWindowBackground}">
                <TextBlock Text="{Binding FileSize}"/>
                <TextBlock Text="{Binding LastModified}"/>
                <TextBox Text="test"/>
              </StackPanel>
            </DataTemplate>
          </pane:PanesTemplateSelector.FileStatsViewTemplate>
          <pane:PanesTemplateSelector.RecentFilesViewTemplate>
            <DataTemplate>
              <view:RecentFilesView />
            </DataTemplate>
          </pane:PanesTemplateSelector.RecentFilesViewTemplate>
        </pane:PanesTemplateSelector>
      </avalonDock:DockingManager.LayoutItemTemplateSelector>

      <avalonDock:DockingManager.LayoutItemContainerStyleSelector>
        <pane:PanesStyleSelector>
          <pane:PanesStyleSelector.ToolStyle>
            <Style TargetType="{x:Type avalonDock:LayoutAnchorableItem}">
              <Setter Property="Title" Value="{Binding Model.Title}"/>
              <Setter Property="IconSource" Value="{Binding Model.IconSource}"/>
              <Setter Property="Visibility" Value="{Binding Model.IsVisible, Mode=TwoWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter={x:Static Visibility.Hidden}}"/>
              <Setter Property="ContentId" Value="{Binding Model.ContentId}"/>
              <Setter Property="IsSelected" Value="{Binding Model.IsSelected, Mode=TwoWay}"/>
              <Setter Property="IsActive" Value="{Binding Model.IsActive, Mode=TwoWay}"/>
            </Style>
          </pane:PanesStyleSelector.ToolStyle>
          <pane:PanesStyleSelector.StartPageStyle>
            <Style TargetType="{x:Type avalonDock:LayoutItem}">
              <Setter Property="Title" Value="{Binding Model.Title}"/>
              <Setter Property="ToolTip" Value="{Binding Model.StartPageTip}"/>
              <Setter Property="CloseCommand" Value="{Binding Model.CloseCommand}"/>
              <Setter Property="IconSource" Value="{Binding Model.IconSource}"/>
              <Setter Property="ContentId" Value="{Binding Model.ContentId}"/>
            </Style>
          </pane:PanesStyleSelector.StartPageStyle>
          <pane:PanesStyleSelector.Log4NetStyle>
            <Style TargetType="{x:Type avalonDock:LayoutItem}">
              <Setter Property="Title" Value="{Binding Model.Title}"/>
              <Setter Property="ToolTip" Value="{Binding Model.ScreenTip}"/>
              <Setter Property="CloseCommand" Value="{Binding Model.CloseCommand}"/>
              <Setter Property="IconSource" Value="{Binding Model.IconSource}"/>
              <Setter Property="ContentId" Value="{Binding Model.ContentId}"/>
            </Style>
          </pane:PanesStyleSelector.Log4NetStyle>
          <pane:PanesStyleSelector.Log4NetToolViewStyle>
            <Style TargetType="{x:Type avalonDock:LayoutAnchorableItem}">
              <Setter Property="Title" Value="{Binding Model.Title}"/>
              <Setter Property="ToolTip" Value="{Binding Model.FilePath}"/>
              <Setter Property="CloseCommand" Value="{Binding Model.CloseCommand}"/>
              <Setter Property="IconSource" Value="{Binding Model.IconSource}"/>
              <Setter Property="ContentId" Value="{Binding Model.ContentId}"/>
            </Style>
          </pane:PanesStyleSelector.Log4NetToolViewStyle>
          <pane:PanesStyleSelector.Log4NetMessageToolViewStyle>
            <Style TargetType="{x:Type avalonDock:LayoutAnchorableItem}">
              <Setter Property="Title" Value="{Binding Model.Title}"/>
              <Setter Property="ToolTip" Value="{Binding Model.FilePath}"/>
              <Setter Property="CloseCommand" Value="{Binding Model.CloseCommand}"/>
              <Setter Property="IconSource" Value="{Binding Model.IconSource}"/>
              <Setter Property="ContentId" Value="{Binding Model.ContentId}"/>
            </Style>
          </pane:PanesStyleSelector.Log4NetMessageToolViewStyle>
          <pane:PanesStyleSelector.FileStyle>
            <Style TargetType="{x:Type avalonDock:LayoutItem}">
              <Setter Property="Title" Value="{Binding Model.Title}"/>
              <Setter Property="ToolTip" Value="{Binding Model.FilePath}"/>
              <Setter Property="CloseCommand" Value="{Binding Model.CloseCommand}"/>
              <Setter Property="IconSource" Value="{Binding Model.IconSource}"/>
              <Setter Property="ContentId" Value="{Binding Model.ContentId}"/>
            </Style>
          </pane:PanesStyleSelector.FileStyle>
          <pane:PanesStyleSelector.RecentFilesStyle>
            <Style TargetType="{x:Type avalonDock:LayoutAnchorableItem}">
              <Setter Property="Title" Value="{Binding Model.Title}"/>
              <Setter Property="ToolTip" Value="{Binding Model.FilePath}"/>
              <Setter Property="CloseCommand" Value="{Binding Model.CloseCommand}"/>
              <Setter Property="IconSource" Value="{Binding Model.IconSource}"/>
              <Setter Property="ContentId" Value="{Binding Model.ContentId}"/>
            </Style>
          </pane:PanesStyleSelector.RecentFilesStyle>
        </pane:PanesStyleSelector>
      </avalonDock:DockingManager.LayoutItemContainerStyleSelector>
      <avalonDock:DockingManager.LayoutUpdateStrategy>
        <pane:LayoutInitializer/>
      </avalonDock:DockingManager.LayoutUpdateStrategy>

      <avalonDock:LayoutRoot>
        <avalonDock:LayoutPanel>
          <avalonDock:LayoutDocumentPane/>
          <avalonDock:LayoutAnchorablePane DockWidth="350">
          </avalonDock:LayoutAnchorablePane>
        </avalonDock:LayoutPanel>
      </avalonDock:LayoutRoot>
    </avalonDock:DockingManager>

    <StatusBar Grid.Row="3" HorizontalAlignment="Stretch">
      <StatusBarItem HorizontalAlignment="Stretch">
        <TextBlock Text="Ready."
                   Grid.Column="0" Margin="0,0,3,0" HorizontalAlignment="Stretch"/>
      </StatusBarItem>

      <StatusBarItem HorizontalAlignment="Right">
        <Grid Grid.Column="1" VerticalAlignment="Bottom" HorizontalAlignment="Right"
              Visibility="{Binding Path=ActiveDocument, Mode=OneWay, Converter={conv:ActiveDocumentToVisibilityConverter}}">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
          </Grid.ColumnDefinitions>

          <Grid Grid.Column="0" Margin="3,0">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="X:"
                       Margin="3,0" Grid.Column="0"/>
            <TextBlock Text="{Binding ActiveEdiDocument.Line, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                       Margin="3,0" Grid.Column="1" MinWidth="10" HorizontalAlignment="Left" />
          </Grid>

          <Grid Grid.Column="1" Margin="3,0">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="Y:"
                       Margin="3,0" Grid.Column="0"/>
            <TextBlock Text="{Binding ActiveEdiDocument.Column, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                       ToolTip="Column of the cursor in the current editor file"
                       Foreground="{DynamicResource StatusBarForegroundColor}"
                       Margin="3,0" Grid.Column="1" MinWidth="10" HorizontalAlignment="Left" />
          </Grid>

          <TextBlock Text="{Binding TextOptions.IsInsertMode, Converter={StaticResource DisplayTypeModeConverter}, Mode=OneWay}"
                     ToolTip="Line of the cursor in the current editor file"
                     DataContext="{Binding ActiveEdiDocument}" Margin="3, 0" Grid.Column="2"/>

          <TextBlock Text="{Binding FileEncoding.EncodingName, Mode=OneWay}"
                     ToolTip="Text Encoding"
                     DataContext="{Binding ActiveEdiDocument}" Margin="3, 0" Grid.Column="3"/>
        </Grid>
      </StatusBarItem>
    </StatusBar>
  </Grid>
</Window>
